#Email respondents to ROI Calculator Google Form
#Google Form Link https://docs.google.com/forms/d/e/1FAIpQLSdZk4GoC312XBTCC8sYyCIy6HUbDYayojoSF0b2I6M2wyL8Qw/viewform
#Hugo and Zena have access to editing the form
#Do not change or add fields without correcting the underneath data index within main functino for loop
#Replace trigger if program seems to not be emailing people (Unlikely unless 2 or more people hit the Submit button in the 2nd slide in form at the same exact second)
""" 
(data[0] : TimeStamp) (data[1] : First inputed Email) (data[2] : First Name) (data[3] : Last Name) (data[4] : Phone Number) (data[5] : Confirmed Email)
(data[6] : 500mg) (data[7] : 1000mg) (data[8] : 4500mg) (data[9] : 6000mg) (data[10] : 250mg) (data[11] : 4oz)
(data[12] : Team Member Selected)
"""
#Imports
import gspread
from oauth2client.service_account import ServiceAccountCredentials
import csv
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
import smtplib
import locale
import schedule
import time

def runIt():
    #Variables
    locale.setlocale( locale.LC_ALL, 'en_US')
    scope = ['https://spreadsheets.google.com/feeds',
            'https://www.googleapis.com/auth/drive']
    creds = ServiceAccountCredentials.from_json_keyfile_name('client_secret.json', scope)
    client = gspread.authorize(creds)
    sheet = client.open('Return On Investment (Responses)').sheet1
    data = sheet.get_all_values()
    del data[0] #Delete header                                                       
    seenTime = []#Trigger
    seenName = []
    seenEmail = []
    secondEmail = []

    #Open seenResponse.csv which holds all past responses
    with open('seenResponse.csv') as csvfile:
        readCSV = csv.reader(csvfile, delimiter=',')
        for row in readCSV:
            seenEmail.append(row[0])
            seenName.append(row[1] + ' ' + row[2])
            seenTime.append(row[5])
            secondEmail.append(row[4])


    def sendEmail(): #data variables explained on top
        for i in data:
            if i[0] not in seenTime:#If data Timestamp has not been seen before ROI will be sent out to data[5] 
                newData = i
                with open('seenResponse.csv', 'a', newline='') as f: #append to seenResponse.csv with new data from recent form submission
                    fieldNames = ['Email','First','Last','Phone','Second Email', 'Time Stamp']
                    thewriter = csv.DictWriter(f, fieldnames = fieldNames)
                    thewriter.writeheader()
                    thewriter.writerow({'Email': newData[1], 'First' : newData[2], 'Last' : newData[3], 'Phone' : newData[4], 'Second Email' : newData[5], 'Time Stamp' : newData[0]})
                print('')
                print('New Time and Email')
                #Total and roi calculations
                total = (30.00 * int(i[6])) + (37.50 * int(i[7])) + (150.00 * int(i[8])) + (186.00 * int(i[9])) + (22.50 * int(i[10])) + (30.00 * int(i[11]))
                roi =  (50.00 * int(i[6])) + (62.50 * int(i[7])) + (249.00 * int(i[8])) + (309.00 * int(i[9])) + (37.50 * int(i[10])) + (50.00 * int(i[11])) - total 
                thousandTotal = (28.80 * int(i[6])) + (36.00 * int(i[7])) + (144.00 * int(i[8])) + (178.56 * int(i[9])) + (21.60 * int(i[10])) + (28.80 * int(i[11]))
                roiYear = (50.00 * int(i[6])) + (62.50 * int(i[7])) + (249.00 * int(i[8])) + (309.00 * int(i[9])) + (37.50 * int(i[10])) + (50.00 * int(i[11])) - thousandTotal
                twentyFiveTotal = (27.60 * int(i[6])) + (34.50 * int(i[7])) + (138.00 * int(i[8])) + (171.12 * int(i[9])) + (20.70 * int(i[10])) + (27.60 * int(i[11]))
                roiYear2 = (50.00 * int(i[6])) + (62.50 * int(i[7])) + (249.00 * int(i[8])) + (309.00 * int(i[9])) + (37.50 * int(i[10])) + (50.00 * int(i[11])) - twentyFiveTotal
                fiveThousandTotal = (26.40 * int(i[6])) + (33.00 * int(i[7])) + (132.00 * int(i[8])) + (163.68 * int(i[9])) + (19.80 * int(i[10])) + (26.40 * int(i[11]))
                roiYear3 = (50.00 * int(i[6])) + (62.50 * int(i[7])) + (249.00 * int(i[8])) + (309.00 * int(i[9])) + (37.50 * int(i[10])) + (50.00 * int(i[11])) - fiveThousandTotal
                tenThousandTotal = (25.20 * int(i[6])) + (31.50 * int(i[7])) + (126.00 * int(i[8])) + (156.24 * int(i[9])) + (18.90 * int(i[10])) + (25.20 * int(i[11]))
                roiYear4 = (50.00 * int(i[6])) + (62.50 * int(i[7])) + (249.00 * int(i[8])) + (309.00 * int(i[9])) + (37.50 * int(i[10])) + (50.00 * int(i[11])) - tenThousandTotal
                #Depending on what their total falls under the appropriate if
                #All if statements show return on investment on one time purchase
                #What separates all statments is the return on investment one year contract prices that get multiplied by data[6] - data[11]
                if total < 999.99:
                    msg = MIMEMultipart()
                    msg['From'] = 'hugo@marijuanadoctors.com'
                    msg['To'] = i[5]
                    msg['Subject'] = 'Return On Investment Calculations'
                    msg['Cc'] = 'zena@marijuanadoctors.com'
                    body = "<body><h3 style='color:rgb(0,54,79);'>Hello, " + i[2] + ' ' + i[3] +"</h3>\n<p style='color:rgb(0,54,79);'> Unfortunatley we could not process your return on investment, due to our minimum purchase order is $1,000. Your total was " + '${:,.2f}'.format(total) + " </p>\n<p>Fill out the <a href='https://docs.google.com/forms/d/e/1FAIpQLSdZk4GoC312XBTCC8sYyCIy6HUbDYayojoSF0b2I6M2wyL8Qw/viewform'> form</a> again.footer><small><a href='https://www.marijuanadoctors.com'>MarijuanaDoctors.com</a></br> A new kind of heal<span style='color:#20AABD;'>thc</span>are</small></footer></body> "  
                    #attach the body to the message as html
                    msg.attach(MIMEText(body, 'html'))
                    print(msg)
                    #initilize the sever
                    server = smtplib.SMTP_SSL('smtp.gmail.com', 465)
                    server.login('hugo@marijuanadoctors.com', '*******')
                    #send the email
                    server.sendmail(msg['from'], msg['To'], msg.as_string())
                    #close the server
                    server.quit()                                     
                if total > 999.99 and total < 2500.0:
                    msg = MIMEMultipart()
                    msg['From'] = 'hugo@marijuanadoctors.com'
                    msg['To'] = i[5]
                    msg['Subject'] = 'Return On Investment Calculations'
                    msg['Cc'] = 'zena@marijuanadoctors.com'
                    body = "<body><h3 style='color:rgb(0,54,79);'>Hello, " + i[2] + ' ' + i[3] +"</h3>\n<h4 style='color:rgb(0,54,79);text-align:center;'>One Time Purchase Cost</h4><table style='border: 1px solid black;border-collapse: collapse;margin-left: auto;margin-right: auto;'><tr><th style='text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;border: 1px solid black;border-collapse: collapse;'>Quantity</th><th style='border: 1px solid black;border-collapse: collapse;text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;'>Product</th><th style='border: 1px solid black;border-collapse: collapse;text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;'>Cost</th></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[6] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>500mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((30.00 * int(i[6])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[7] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>1000mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((37.50 * int(i[7])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[8] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>4500mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((150.00 * int(i[8])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[9] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>6000mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((186.00 * int(i[9])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[10] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>250mg Tincture K-9</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((22.50 * int(i[10])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[11] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>4oz Muscle Cream</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((30.00 * int(i[11])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2; border-left: none; border-right: none; background-color: #f2f2f2;'><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>Total Cost: </td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>" + '${:,.2f}'.format(total) + "</td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'></td></tr><tr style='background-color: #f2f2f2; border-left: none; border-right: none; background-color: #f2f2f2;'><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>Return on Investment: </td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>"+ '${:,.2f}'.format(roi) +"</td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'></td></tr></table><small>*Return on investment is based on SRP</small>\n<h4 style='color:rgb(0,54,79);text-align:center;'>1 Year Contract Price</h4><table style='border: 1px solid black;border-collapse: collapse;margin-left: auto;margin-right: auto;'><tr><th style='text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;border: 1px solid black;border-collapse: collapse;'>Quantity</th><th style='border: 1px solid black;border-collapse: collapse;text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;'>Product</th><th style='border: 1px solid black;border-collapse: collapse;text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;'>Cost</th></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[6] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>500mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((28.80 * int(i[6])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[7] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>1000mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((36.00 * int(i[7])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[8] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>4500mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((144.00 * int(i[8])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[9] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>6000mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((178.56 * int(i[9])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[10] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>250mg Tincture K-9</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((21.60 * int(i[10])),2), grouping=True)) + "</td></tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[11] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>4oz Muscle Cream</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((28.80 * int(i[11])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2; border-left: none; border-right: none; background-color: #f2f2f2;'><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>Total Cost: </td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>"+ '${:,.2f}'.format(thousandTotal) + "</td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'></td></tr><tr style='background-color: #f2f2f2; border-left: none; border-right: none; background-color: #f2f2f2;'><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>Return on Investment: </td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>" + '${:,.2f}'.format(roiYear) + "</td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'></td></tr></table><small>*Return on investment is based on SRP</small>\n</br>\n<div style='background-color:#00364F;'><p style='color:white; padding:20px;'>We appreciate the time to check how we can increase the revenue for your business.</br>We Welcome the opportunity to talk and discuss a real strategy to capitilize on the CBD market.</br><a href='https://docs.google.com/forms/d/1a1SsAw5nBPqzlQP7ln_mqqVzt7oX7ucEZlGpIqTNiBw/'>Click Here</a> to schedule an appointment to speak with one of our sales representatives.</p></div>\n</body><footer><small><a href='https://www.marijuanadoctors.com'>MarijuanaDoctors.com</a></br> A new kind of heal<span style='color:#20AABD;'>thc</span>are</small></footer></body>"
                    #attach the body to the message as html
                    msg.attach(MIMEText(body, 'html'))
                    print(msg)
                    #initilize the sever
                    server = smtplib.SMTP_SSL('smtp.gmail.com', 465)
                    server.login('hugo@marijuanadoctors.com', '*******')
                    #send the email
                    server.sendmail(msg['from'], msg['To'], msg.as_string())
                    #close the server
                    server.quit()
                if total > 2499.99 and total < 5000.00:
                    msg = MIMEMultipart()
                    msg['From'] = 'hugo@marijuanadoctors.com'
                    msg['To'] = i[5]
                    msg['Subject'] = 'Return On Investment Calculations'
                    msg['Cc'] = 'zena@marijuanadoctors.com'
                    body = "<body><h3 style='color:rgb(0,54,79);'>Hello, " + i[2] + ' ' + i[3] +"</h3>\n<h4 style='color:rgb(0,54,79);text-align:center;'>One Time Purchase Cost</h4><table style='border: 1px solid black;border-collapse: collapse;margin-left: auto;margin-right: auto;'><tr><th style='text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;border: 1px solid black;border-collapse: collapse;'>Quantity</th><th style='border: 1px solid black;border-collapse: collapse;text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;'>Product</th><th style='border: 1px solid black;border-collapse: collapse;text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;'>Cost</th></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[6] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>500mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((30.00 * int(i[6])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[7] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>1000mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((37.50 * int(i[7])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[8] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>4500mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((150.00 * int(i[8])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[9] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>6000mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((186.00 * int(i[9])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[10] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>250mg Tincture K-9</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((22.50 * int(i[10])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[11] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>4oz Muscle Cream</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((30.00 * int(i[11])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2; border-left: none; border-right: none; background-color: #f2f2f2;'><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>Total Cost: </td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>" + '${:,.2f}'.format(total) + "</td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'></td></tr><tr style='background-color: #f2f2f2; border-left: none; border-right: none; background-color: #f2f2f2;'><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>Return on Investment: </td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>"+ '${:,.2f}'.format(roi) +"</td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'></td></tr></table><small>*Return on investment is based on SRP</small>\n<h4 style='color:rgb(0,54,79);text-align:center;'>1 Year Contract Price</h4><table style='border: 1px solid black;border-collapse: collapse;margin-left: auto;margin-right: auto;'><tr><th style='text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;border: 1px solid black;border-collapse: collapse;'>Quantity</th><th style='border: 1px solid black;border-collapse: collapse;text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;'>Product</th><th style='border: 1px solid black;border-collapse: collapse;text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;'>Cost</th></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[6] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>500mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((27.60 * int(i[6])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[7] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>1000mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((34.50 * int(i[7])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[8] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>4500mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((138.00 * int(i[8])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[9] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>6000mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((171.12 * int(i[9])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[10] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>250mg Tincture K-9</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((20.70 * int(i[10])),2), grouping=True)) + "</td></tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[11] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>4oz Muscle Cream</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((27.60 * int(i[11])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2; border-left: none; border-right: none; background-color: #f2f2f2;'><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>Total Cost: </td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>"+ '${:,.2f}'.format(twentyFiveTotal) + "</td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'></td></tr><tr style='background-color: #f2f2f2; border-left: none; border-right: none; background-color: #f2f2f2;'><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>Return on Investment: </td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>" + '${:,.2f}'.format(roiYear2) + "</td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'></td></tr></table><small>*Return on investment is based on SRP</small>\n</br>\n<div style='background-color:#00364F;'><p style='color:white; padding:20px;'>We appreciate the time to check how we can increase the revenue for your business.</br>We Welcome the opportunity to talk and discuss a real strategy to capitilize on the CBD market.</br><a href='https://docs.google.com/forms/d/1a1SsAw5nBPqzlQP7ln_mqqVzt7oX7ucEZlGpIqTNiBw/'>Click Here</a> to schedule an appointment to speak with one of our sales representatives.</p></div>\n</body><footer><small><a href='https://www.marijuanadoctors.com'>MarijuanaDoctors.com</a></br> A new kind of heal<span style='color:#20AABD;'>thc</span>are</small></footer></body>"
                    #attach the body to the message as html
                    msg.attach(MIMEText(body, 'html'))            
                    print(msg)
                    #Initilize the server
                    server = smtplib.SMTP_SSL('smtp.gmail.com', 465)
                    server.login('hugo@marijuanadoctors.com', '****')
                    #send the email
                    server.sendmail(msg['from'], msg['To'], msg.as_string())
                    #close the server
                    server.quit()
                if total > 4999.99 and total < 10000.00:
                    msg = MIMEMultipart()
                    msg['From'] = 'hugo@marijuanadoctors.com'
                    msg['To'] = i[5]
                    msg['Subject'] = 'Return On Investment Calculations'
                    msg['Cc'] = 'zena@marijuanadoctors.com'
                    body = "<body><h3 style='color:rgb(0,54,79);'>Hello, " + i[2] + ' ' + i[3] +"</h3>\n<h4 style='color:rgb(0,54,79);text-align:center;'>One Time Purchase Cost</h4><table style='border: 1px solid black;border-collapse: collapse;margin-left: auto;margin-right: auto;'><tr><th style='text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;border: 1px solid black;border-collapse: collapse;'>Quantity</th><th style='border: 1px solid black;border-collapse: collapse;text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;'>Product</th><th style='border: 1px solid black;border-collapse: collapse;text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;'>Cost</th></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[6] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>500mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((30.00 * int(i[6])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[7] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>1000mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((37.50 * int(i[7])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[8] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>4500mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((150.00 * int(i[8])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[9] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>6000mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((186.00 * int(i[9])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[10] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>250mg Tincture K-9</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((22.50 * int(i[10])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[11] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>4oz Muscle Cream</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((30.00 * int(i[11])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2; border-left: none; border-right: none; background-color: #f2f2f2;'><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>Total Cost: </td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>" + '${:,.2f}'.format(total) + "</td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'></td></tr><tr style='background-color: #f2f2f2; border-left: none; border-right: none; background-color: #f2f2f2;'><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>Return on Investment: </td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>"+ '${:,.2f}'.format(roi) +"</td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'></td></tr></table><small>*Return on investment is based on SRP</small>\n<h4 style='color:rgb(0,54,79);text-align:center;'>1 Year Contract Price</h4><table style='border: 1px solid black;border-collapse: collapse;margin-left: auto;margin-right: auto;'><tr><th style='text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;border: 1px solid black;border-collapse: collapse;'>Quantity</th><th style='border: 1px solid black;border-collapse: collapse;text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;'>Product</th><th style='border: 1px solid black;border-collapse: collapse;text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;'>Cost</th></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[6] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>500mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((26.40 * int(i[6])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[7] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>1000mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((33.00 * int(i[7])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[8] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>4500mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((132.00 * int(i[8])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[9] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>6000mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((163.68 * int(i[9])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[10] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>250mg Tincture K-9</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((19.80 * int(i[10])),2), grouping=True)) + "</td></tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[11] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>4oz Muscle Cream</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((26.40 * int(i[11])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2; border-left: none; border-right: none; background-color: #f2f2f2;'><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>Total Cost: </td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>"+ '${:,.2f}'.format(fiveThousandTotal) + "</td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'></td></tr><tr style='background-color: #f2f2f2; border-left: none; border-right: none; background-color: #f2f2f2;'><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>Return on Investment: </td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>" + '${:,.2f}'.format(roiYear3) + "</td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'></td></tr></table><small>*Return on investment is based on SRP</small>\n</br>\n<div style='background-color:#00364F;'><p style='color:white; padding:20px;'>We appreciate the time to check how we can increase the revenue for your business.</br>We Welcome the opportunity to talk and discuss a real strategy to capitilize on the CBD market.</br><a href='https://docs.google.com/forms/d/1a1SsAw5nBPqzlQP7ln_mqqVzt7oX7ucEZlGpIqTNiBw/'>Click Here</a> to schedule an appointment to speak with one of our sales representatives.</p></div>\n</body><footer><small><a href='https://www.marijuanadoctors.com'>MarijuanaDoctors.com</a></br> A new kind of heal<span style='color:#20AABD;'>thc</span>are</small></footer></body>"
                    #attach the body to the message as html
                    msg.attach(MIMEText(body, 'html'))
                    print(msg)
                    #initilize the server
                    server = smtplib.SMTP_SSL('smtp.gmail.com', 465)
                    server.login('hugo@marijuanadoctors.com', '*******')
                    #send the email
                    server.sendmail(msg['from'], msg['To'], msg.as_string())
                    #close the server
                    server.quit() 
                if total > 9999.99:
                    msg = MIMEMultipart()
                    msg['From'] = 'hugo@marijuanadoctors.com'
                    msg['To'] = i[5]
                    msg['Subject'] = 'Return On Investment Calculations'
                    msg['Cc'] = 'zena@marijuanadoctors.com'
                    body = "<body><h3 style='color:rgb(0,54,79);'>Hello, " + i[2] + ' ' + i[3] +"</h3>\n<h4 style='color:rgb(0,54,79);text-align:center;'>One Time Purchase Cost</h4><table style='border: 1px solid black;border-collapse: collapse;margin-left: auto;margin-right: auto;'><tr><th style='text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;border: 1px solid black;border-collapse: collapse;'>Quantity</th><th style='border: 1px solid black;border-collapse: collapse;text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;'>Product</th><th style='border: 1px solid black;border-collapse: collapse;text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;'>Cost</th></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[6] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>500mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((30.00 * int(i[6])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[7] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>1000mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((37.50 * int(i[7])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[8] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>4500mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((150.00 * int(i[8])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[9] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>6000mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((186.00 * int(i[9])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[10] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>250mg Tincture K-9</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((22.50 * int(i[10])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[11] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>4oz Muscle Cream</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((30.00 * int(i[11])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2; border-left: none; border-right: none; background-color: #f2f2f2;'><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>Total Cost: </td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>" + '${:,.2f}'.format(total) + "</td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'></td></tr><tr style='background-color: #f2f2f2; border-left: none; border-right: none; background-color: #f2f2f2;'><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>Return on Investment: </td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>"+ '${:,.2f}'.format(roi) +"</td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'></td></tr></table><small>*Return on investment is based on SRP</small>\n<h4 style='color:rgb(0,54,79);text-align:center;'>1 Year Contract Price</h4><table style='border: 1px solid black;border-collapse: collapse;margin-left: auto;margin-right: auto;'><tr><th style='text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;border: 1px solid black;border-collapse: collapse;'>Quantity</th><th style='border: 1px solid black;border-collapse: collapse;text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;'>Product</th><th style='border: 1px solid black;border-collapse: collapse;text-align: center;background-color: #00364F;color: white;padding: 25px;font-family: Arial Black;font-size: 15px;'>Cost</th></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[6] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>500mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((25.20 * int(i[6])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[7] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>1000mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((31.50 * int(i[7])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[8] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>4500mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + str(locale.currency(round((126.00 * int(i[8])),2), grouping=True)) + "</td></tr><tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[9] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>6000mg Tincture</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((156.24 * int(i[9])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2;'><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[10] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>250mg Tincture K-9</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((18.90 * int(i[10])),2), grouping=True)) + "</td></tr><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>" + i[11] + "</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>4oz Muscle Cream</td><td style='border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;'>"+ str(locale.currency(round((25.20 * int(i[11])),2), grouping=True)) + "</td></tr><tr style='background-color: #f2f2f2; border-left: none; border-right: none; background-color: #f2f2f2;'><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>Total Cost: </td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>"+ '${:,.2f}'.format(tenThousandTotal) + "</td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'></td></tr><tr style='background-color: #f2f2f2; border-left: none; border-right: none; background-color: #f2f2f2;'><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>Return on Investment: </td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'>" + '${:,.2f}'.format(roiYear4) + "</td><td style = 'border: 1px solid black;border-collapse: collapse;text-align: center;padding: 15px;font-family: Lucida Sans Unicode;border-left: none;border-right: none;background-color: #f2f2f2;'></td></tr></table><small>*Return on investment is based on SRP</small>\n</br>\n<div style='background-color:#00364F;'><p style='color:white; padding:20px;'>We appreciate the time to check how we can increase the revenue for your business.</br>We Welcome the opportunity to talk and discuss a real strategy to capitilize on the CBD market.</br><a href='https://docs.google.com/forms/d/1a1SsAw5nBPqzlQP7ln_mqqVzt7oX7ucEZlGpIqTNiBw/'>Click Here</a> to schedule an appointment to speak with one of our sales representatives.</p></div>\n</body><footer><small><a href='https://www.marijuanadoctors.com'>MarijuanaDoctors.com</a></br> A new kind of heal<span style='color:#20AABD;'>thc</span>are</small></footer></body>"
                    #attach the body to the message as html
                    msg.attach(MIMEText(body, 'html'))
                    print(msg)
                    #initilize the server
                    server = smtplib.SMTP_SSL('smtp.gmail.com', 465)
                    server.login('hugo@marijuanadoctors.com', '********')
                    server.sendmail(msg['from'], msg['To'], msg.as_string())
                    #close the server
                    server.quit()                       
            else:
                #Else when there is no new data
                print('No New Data')
    #Send email function call
    sendEmail()
    print('Succesfully sent email')     

#Schule function runIt to run every 1 minute
schedule.every(1).minutes.do(runIt)

#infinite loop to run schedule
while 1:
    schedule.run_pending()
    time.sleep(1)